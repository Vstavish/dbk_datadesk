---
title: "salary_2022_analysis"
author: "Victoria Stavish"
date: "2022-10-20"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# load libraries

```{r cars}

library(tidyverse)
library(janitor)
library(lubridate)
library(dplyr)
library(readxl)
library(ggplot2)

```

# load data

```{r}

salary_2022 <- read_xlsx("salary_2022.xlsx")

```

# create dataframe of only non-tenured faculty
# there are 3,343 non-tenured faculty

```{r}

non_tenured <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(grepl("Non-Tenured", category_status))

non_tenured_sum <- non_tenured %>%
  summarise(
    appt_base_annual_salary = sum(appt_base_annual_salary, na.rm=TRUE)
  )

avg_non_tenured <- non_tenured_sum /3343

```

# tenured
# there are 1,353 tenured faculty

```{r}
tenured <- salary_2022 %>%
as.data.frame() %>%
  clean_names() %>%
  filter(grepl("Tenured Faculty", category_status))

tenured_sum <- tenured %>%
  summarise(
    appt_base_annual_salary = sum(appt_base_annual_salary, na.rm=TRUE)
  )

avg_tenured <- tenured_sum /1353


```

# tenure and non-tenure faculty by division

```{r}

by_division <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  select(division, category_status, appt_base_annual_salary) %>%
  filter(grepl("Tenured | Tenure | Non", category_status)) %>%
  group_by(division, category_status) %>%
  count(category_status)

```

# how many faculty in each division?

```{r}
division_faculty <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  group_by(division) %>%
  count(division) %>%
  arrange(desc(n))

```

# avg tenure and non-tenure salary by division

```{r}

engineering <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "A. James Clark School of Engineering") %>%
  group_by(category_status_cd) %>%
  count(category_status_cd)


  #filter(category_status_cd == "03 | 15 | 37") %>%
  group_by(category_status) %>%
  summarise( = sum(total_pills)) %>%
  


  

```





