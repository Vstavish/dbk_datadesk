---
title: "salary_2022_analysis"
author: "Victoria Stavish"
date: "2022-10-20"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# load libraries

```{r cars}

library(tidyverse)
library(janitor)
library(lubridate)
library(dplyr)
library(readxl)
library(ggplot2)
library(writexl)

```

# load data

```{r}

salary_2022 <- read_xlsx("salary_2022.xlsx")

```

```{r}
count_engineering <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(grepl("Tenured Faculty|Tenure Track Faculty|Non-Tenured,Cont. Contr. Faculty|Non-Tenured, Term. Contr. Faculty|Non-Tenured, Non-Regular Faculty", category_status)) %>%
  filter(division == "A. James Clark School of Engineering") %>%
  group_by(appt_base_annual_salary, primary_name, category_status) %>%
  count()

count_engineering <- count_engineering %>%
  group_by(category_status) %>%
  count()

count_cmns <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(grepl("Tenured Faculty|Tenure Track Faculty|Non-Tenured,Cont. Contr. Faculty|Non-Tenured, Term. Contr. Faculty|Non-Tenured, Non-Regular Faculty", category_status)) %>%
  filter(division == "College of Computer, Math & Natural Sciences") %>%
  group_by(appt_base_annual_salary, primary_name, category_status) %>%
  count()

count_cmns <- count_cmns %>%
  group_by(category_status) %>%
  count()

count_agr <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(grepl("Tenured Faculty|Tenure Track Faculty|Non-Tenured,Cont. Contr. Faculty|Non-Tenured, Term. Contr. Faculty|Non-Tenured, Non-Regular Faculty", category_status)) %>%
  filter(division == "College of Agriculture & Natural Resources") %>%
  group_by(appt_base_annual_salary, primary_name, category_status) %>%
  count()

count_agr <- count_agr %>%
  group_by(category_status) %>%
  count()

count_arhu <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(grepl("Tenured Faculty|Tenure Track Faculty|Non-Tenured,Cont. Contr. Faculty|Non-Tenured, Term. Contr. Faculty|Non-Tenured, Non-Regular Faculty", category_status)) %>%
  filter(division == "College of Arts & Humanities") %>%
  group_by(appt_base_annual_salary, primary_name, category_status) %>%
  count()

count_arhu <- count_arhu %>%
  group_by(category_status) %>%
  count()

count_bsos <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(grepl("Tenured Faculty|Tenure Track Faculty|Non-Tenured,Cont. Contr. Faculty|Non-Tenured, Term. Contr. Faculty|Non-Tenured, Non-Regular Faculty", category_status)) %>%
  filter(division == "College of Behavioral & Social Sciences") %>%
  group_by(appt_base_annual_salary, primary_name, category_status) %>%
  count()

count_bsos <- count_bsos %>%
  group_by(category_status) %>%
  count()

count_education <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(grepl("Tenured Faculty|Tenure Track Faculty|Non-Tenured,Cont. Contr. Faculty|Non-Tenured, Term. Contr. Faculty|Non-Tenured, Non-Regular Faculty", category_status)) %>%
  filter(division == "College of Education") %>%
  group_by(appt_base_annual_salary, primary_name, category_status) %>%
  count()

count_education <- count_education %>%
  group_by(category_status) %>%
  count()

count_infosci <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(grepl("Tenured Faculty|Tenure Track Faculty|Non-Tenured,Cont. Contr. Faculty|Non-Tenured, Term. Contr. Faculty|Non-Tenured, Non-Regular Faculty", category_status)) %>%
  filter(division == "College of Information Studies") %>%
  group_by(appt_base_annual_salary, primary_name, category_status) %>%
  count()

count_infosci <- count_infosci %>%
  group_by(category_status) %>%
  count()

count_jour <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(grepl("Tenured Faculty|Tenure Track Faculty|Non-Tenured,Cont. Contr. Faculty|Non-Tenured, Term. Contr. Faculty|Non-Tenured, Non-Regular Faculty", category_status)) %>%
  filter(division == "Philip Merrill College of Journalism")%>%
  group_by(appt_base_annual_salary, primary_name, category_status) %>%
  count()

count_jour <- count_jour %>%
  group_by(category_status) %>%
  count()

count_business <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(grepl("Tenured Faculty|Tenure Track Faculty|Non-Tenured,Cont. Contr. Faculty|Non-Tenured, Term. Contr. Faculty|Non-Tenured, Non-Regular Faculty", category_status)) %>%
  filter(division == "Robert H. Smith School of Business") %>%
  group_by(appt_base_annual_salary, primary_name, category_status) %>%
  count()

count_business <- count_business %>%
  group_by(category_status) %>%
  count()

count_arch <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(grepl("Tenured Faculty|Tenure Track Faculty|Non-Tenured,Cont. Contr. Faculty|Non-Tenured, Term. Contr. Faculty|Non-Tenured, Non-Regular Faculty", category_status)) %>%
  filter(division == "School of Architecture, Planning, & Preservation")%>%
  group_by(appt_base_annual_salary, primary_name, category_status) %>%
  count()

count_arch <- count_arch %>%
  group_by(category_status) %>%
  count()

count_sph <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(grepl("Tenured Faculty|Tenure Track Faculty|Non-Tenured,Cont. Contr. Faculty|Non-Tenured, Term. Contr. Faculty|Non-Tenured, Non-Regular Faculty", category_status)) %>%
  filter(division == "School of Public Health")%>%
  group_by(appt_base_annual_salary, primary_name, category_status) %>%
  count()

count_sph <- count_sph %>%
  group_by(category_status) %>%
  count()

count_policy <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(grepl("Tenured Faculty|Tenure Track Faculty|Non-Tenured,Cont. Contr. Faculty|Non-Tenured, Term. Contr. Faculty|Non-Tenured, Non-Regular Faculty", category_status)) %>%
  filter(division == "School of Public Policy")%>%
  group_by(appt_base_annual_salary, primary_name, category_status) %>%
  count()

count_policy <- count_policy %>%
  group_by(category_status) %>%
  count()
```


#position types 

# Non-Tenured, Non-Regular Faculty (37) --> 
Faculty positions are academic positions, that involve teaching, research, scholarship, artistic creativity or academic administration. “Faculty Non-Regular, Non-tenured” is an employment category assigned to Faculty who have a paid appointment of less than 6 months, or are non-paid. As such, they are non-regular employees who are not eligible for any benefits, retirement, or paid leave. Faculty Non-Regular, Non-tenured appointees are paid on a salary with an FTE appropriate to their level of work. Paid faculty working under this category will receive wages for Paid Holidays or Administrative Leave incurred during their contract term. Generally appointees to this category will be term-only Lecturers, Faculty Research Assistants, and some visiting faculty.
# Non-Tenured, Term. Contr. Faculty (03) --> 
Faculty positions are academic positions that involve teaching, research, scholarship, artistic creativity or academic administration. “Faculty Non-tenured, Term Contract” is a “regular” employment category assigned to faculty who have a renewable appointment, which does not carry tenure. Appointees to this category will be eligible for full benefits and must be salaried. The appointee must be paid on an account with a subcode in the 1000 series; such account can be state, self-support, or contract & grant. His/her appointment must be renewed at each expiration.
# Non-Tenured,Cont. Contr. Faculty (15) --> 
Faculty positions are academic positions that involve teaching, research, scholarship, artistic creativity, or academic administration. “Faculty Non-tenured, Continuing” is an employment category assigned to faculty who have been appointed to a continuing appointment which does not carry tenure. Appointees to this category may be eligible for benefits as defined in the contract, and must be salaried. The appointee must be on a line item in the state budget and his/her appointment does not need to be renewed each year, but may be if so stipulated in the employment agreement. This category is typically used for faculty research assistants, grand-parented instructors with job security, officers and deans without faculty rank, professional librarians, and university coaches. Continuing appointments supported on research or self-support funds must be renewed each year. If it is intended to hire a faculty member on the tenure track but s/he does not have degree transcript documentation, s/he may be hired into this Non-tenured, Continuing and Term Contract category until the degree documentation is received. If tenure is not granted to a tenure-track faculty member, s/he is given a one-year terminal non-tenured faculty position in this category.
# Tenure Track Faculty (02) --> 
Faculty positions are academic positions that involve teaching, research, scholarship, artistic creativity or academic administration. “Faculty Non-tenured on Track” is an employment category assigned to faculty who are hired on the tenure-track and are eligible for a tenure review as defined in the institution’s policy on the Appointment, Promotion and Tenure of Faculty. New tenure-track faculty can be hired at the rank of assistant professor or associate professor. For detailed information about the policies and procedures for appointing tenure-track faculty, please visit the Office of Faculty Affairs website.
# Tenured Faculty (01) --> 
Faculty positions are academic positions that involve teaching, research, scholarship, artistic creativity or academic administration. “Faculty Tenured” is an employment category assigned to faculty who have been granted tenure with their initial appointment or through a tenure review process after serving up to six years in a tenure-track appointment. Initial appointments to the position of full professor carry automatic tenure. Tenure-bearing ranks are Associate Professor, Professor, and Distinguished University Professor. Tenure guarantees a faculty member continued employment until s/he resigns or retires, is terminated for just cause, is dismissed due to programmatic discontinuation, is deemed to have abandoned her/his position, or dies. Initial appointments to the title of Associate Professor can be tenured or tenure-track. There are some Assistant Professors who have been grandfathered with tenure.

```{r}

position_types <- salary_2022 %>%
  clean_names() %>%
  filter(!grepl("Tenured Faculty", category_status)) %>%
  count()

```

# avg salary by position

```{r}
avg_position_salary <- salary_2022 %>%
  clean_names() %>%
  select(division, category_status, category_status_cd, appt_base_annual_salary, primary_name) %>%
  filter(grepl("Tenured Faculty|Tenure Track Faculty|Non-Tenured,Cont. Contr. Faculty|Non-Tenured, Term. Contr. Faculty|Non-Tenured, Non-Regular Faculty", category_status)) %>%
  filter(!str_detect("VP Research|Graduate School|Undergraduate Studies| Office of the President|Sr VP Academic Affairs & Provost|VP Student Affairs|Libraries|Universities at Shady Grove|Office of Extended Studies", division))


library(openxlsx)

avg_position_salary <- list('Sheet1' = avg_position_salary)
write.xlsx(avg_position_salary, file = 'C:/Users/Vstav/OneDrive/Documents/GitHub/this_one.xlsx')
```


```{r}

count_engineering <- avg_position_salary %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(grepl("Tenured Faculty|Tenure Track Faculty|Non-Tenured,Cont. Contr. Faculty|Non-Tenured, Term. Contr. Faculty|Non-Tenured, Non-Regular Faculty", category_status)) %>%
  filter(division == "A. James Clark School of Engineering") %>%
  group_by(appt_base_annual_salary, primary_name, category_status) %>%
  count()

count_engineering <- count_engineering %>%
  group_by(category_status) %>%
  count()
```


```{r}
group_by(category_status, category_status_cd, division) %>% 
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  ) %>%
  arrange(desc(appt_base_annual_salary))

write_xlsx(avg_position_salary,'salary_breakdown_position_division.xlsx')

avg_tenure_salary <- salary_2022 %>%
  clean_names() %>%
  select(division, category_status, category_status_cd, appt_base_annual_salary) %>%
  filter(grepl("Tenured Faculty", category_status)) %>%
  filter(!str_detect("VP Research|Graduate School|Undergraduate Studies| Office of the President|Sr VP Academic Affairs & Provost|VP Student Affairs|Libraries|Shady Grove", division)) %>%
  group_by(category_status, category_status_cd, division) %>% 
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  ) %>%
  arrange(desc(appt_base_annual_salary))


avg_ptk_salary <- salary_2022 %>%
  clean_names() %>%
  select(division, category_status, category_status_cd, appt_base_annual_salary) %>%
  filter(grepl("Tenure Track Faculty", category_status)) %>%
  filter(!str_detect("VP Research|Graduate School|Undergraduate Studies| Office of the President|Sr VP Academic Affairs & Provost|VP Student Affairs|Libraries|Shady Grove", division)) %>%
  group_by(category_status, category_status_cd, division) %>% 
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  ) %>%
  arrange(desc(appt_base_annual_salary))

avg_cont_contract_salary <- salary_2022 %>%
  clean_names() %>%
  select(division, category_status, category_status_cd, appt_base_annual_salary) %>%
  filter(grepl("Non-Tenured,Cont. Contr. Faculty", category_status)) %>%
  filter(!str_detect("VP Research|Graduate School|Undergraduate Studies| Office of the President|Sr VP Academic Affairs & Provost|VP Student Affairs|Libraries|Shady Grove", division)) %>%
  group_by(category_status, category_status_cd, division) %>% 
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  ) %>%
  arrange(desc(appt_base_annual_salary))

  
avg_term_contract_salary <- salary_2022 %>%
  clean_names() %>%
  select(division, category_status, category_status_cd, appt_base_annual_salary) %>%
  filter(grepl("Non-Tenured, Term. Contr. Faculty", category_status)) %>%
  filter(!str_detect("VP Research|Graduate School|Undergraduate Studies| Office of the President|Sr VP Academic Affairs & Provost|VP Student Affairs|Libraries|Shady Grove", division)) %>%
  group_by(category_status, category_status_cd, division) %>% 
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  ) %>%
  arrange(desc(appt_base_annual_salary))

avg_non_reg_salary <- salary_2022 %>%
  clean_names() %>%
  select(division, category_status, category_status_cd, appt_base_annual_salary) %>%
  filter(grepl("Non-Tenured, Non-Regular Faculty", category_status)) %>%
  filter(!str_detect("VP Research|Graduate School|Undergraduate Studies| Office of the President|Sr VP Academic Affairs & Provost|VP Student Affairs|Libraries|Shady Grove", division)) %>%
  group_by(category_status, category_status_cd, division) %>% 
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  ) %>%
  arrange(desc(appt_base_annual_salary))

library(openxlsx)

all_salary_avgs <- list('Sheet1' = avg_tenure_salary, 'Sheet2' = avg_ptk_salary, 'Sheet3' = avg_cont_contract_salary, 'Sheet4' = avg_term_contract_salary, 'Sheet5' = avg_non_reg_salary)
write.xlsx(all_salary_avgs, file = 'C:/Users/Vstav/OneDrive/Documents/GitHub/dbk_datadesk/salary_analysis/avg_salary_by_position.xlsx')

```



# create dataframe of only non-tenured faculty
# there are 3,343 non-tenured faculty

```{r}

non_tenured <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(grepl("Non-Tenured", category_status))

non_tenured_sum <- non_tenured %>%
  summarise(
    appt_base_annual_salary = sum(appt_base_annual_salary, na.rm=TRUE)
  )

avg_non_tenured <- non_tenured_sum /3343

total_faculty <- 3343+1353

pct_tenured <- 1353/4696
# about 29% of professors and lecturers faculty are tenured 

```

# tenured
# there are 1,353 tenured faculty

```{r}
tenured <- salary_2022 %>%
as.data.frame() %>%
  clean_names() %>%
  filter(grepl("Tenured Faculty", category_status))

tenured_sum <- tenured %>%
  summarise(
    appt_base_annual_salary = sum(appt_base_annual_salary, na.rm=TRUE)
  )

avg_tenured <- tenured_sum /1353


```

# tenure and non-tenure faculty by division

```{r}

by_division <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  select(division, category_status, appt_base_annual_salary) %>%
  filter(!str_detect("Exempt Regular|Nonexempt Regular|Exempt Contingent II|Nonexempt Contingent II", category_status)) %>%
  group_by(division, category_status) %>%
  count(category_status) %>%
  pivot_wider(names_from=category_status, values_from=n) %>%
  clean_names() %>%
  mutate(pct_non_tenured = (non_tenured_non_regular_faculty/tenured_faculty)*100)

```

# how many faculty in each division?

```{r}
division_faculty <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  group_by(division) %>%
  count(division) %>%
  arrange(desc(n))

```

# avg tenure and non-tenure salary by division

```{r}

engineering <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "A. James Clark School of Engineering") %>%
  group_by(category_status_cd, category_status) %>%
  count(category_status_cd)

cmns <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "College of Computer, Math & Natural Sciences") %>%
  group_by(category_status_cd, category_status) %>%
  count(category_status_cd)

pres <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "Office of the President") %>%
  group_by(category_status_cd, category_status) %>%
  count(category_status_cd)

agr <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "College of Agriculture & Natural Resources") %>%
  group_by(category_status_cd, category_status) %>%
  count(category_status_cd)

arhu <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "	
College of Arts & Humanities") %>%
  group_by(category_status_cd, category_status) %>%
  count(category_status_cd)

bsos <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "College of Behavioral & Social Sciences") %>%
  group_by(category_status_cd, category_status) %>%
  count(category_status_cd)

education <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "College of Education") %>%
  group_by(category_status_cd, category_status) %>%
  count(category_status_cd)

infosci <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "College of Information Studies") %>%
  group_by(category_status_cd, category_status) %>%
  count(category_status_cd)

jour <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "Philip Merrill College of Journalism") %>%
  group_by(category_status_cd, category_status) %>%
  count(category_status_cd)

business <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "Robert H. Smith School of Business") %>%
  group_by(category_status_cd, category_status) %>%
  count(category_status_cd)

architecture <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "School of Architecture, Planning, & Preservation") %>%
  group_by(category_status_cd, category_status) %>%
  count(category_status_cd)

sph <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "School of Public Health") %>%
  group_by(category_status_cd, category_status) %>%
  count(category_status_cd)

policy <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "School of Public Policy") %>%
  group_by(category_status_cd, category_status) %>%
  count(category_status_cd)

```

# avg salary by division


```{r}

salengineering <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "A. James Clark School of Engineering") %>%
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  )
  

salcmns <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "College of Computer, Math & Natural Sciences") %>%
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  )

salpres <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "Office of the President") %>%
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  )

salagr <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "College of Agriculture & Natural Resources") %>%
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  )

salarhu <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "	
College of Arts & Humanities") %>%
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  )

salbsos <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "College of Behavioral & Social Sciences") %>%
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  )

saleducation <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "College of Education") %>%
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  )

salinfosci <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "College of Information Studies") %>%
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  )

saljour <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "Philip Merrill College of Journalism") %>%
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  )

salbusiness <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "Robert H. Smith School of Business") %>%
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  )

salarchitecture <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "School of Architecture, Planning, & Preservation") %>%
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  )

salsph <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "School of Public Health") %>%
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  )

salpolicy <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "School of Public Policy") %>%
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  )

```

# tenure faculty salary by division

```{r}

nonengineering <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "A. James Clark School of Engineering") %>%
  filter(category_status_cd %in%  c("15", "03", "37")) %>%
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  )
  

noncmns <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "College of Computer, Math & Natural Sciences") %>%
  filter(category_status_cd %in%  c("15", "03", "37")) %>%
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  )

nonpres <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "Office of the President")%>%
  filter(category_status_cd %in%  c("15", "03", "37")) %>%
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  )

nonagr <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "College of Agriculture & Natural Resources") %>%
  filter(category_status_cd %in%  c("15", "03", "37")) %>%
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  )

nonarhu <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "College of Arts & Humanities") %>%
  filter(category_status_cd %in%  c("15", "03", "37")) %>%
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  )

nonbsos <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "College of Behavioral & Social Sciences") %>%
  filter(category_status_cd %in%  c("15", "03", "37")) %>%
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  )

noneducation <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "College of Education") %>%
  filter(category_status_cd %in%  c("15", "03", "37")) %>%
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  )

noninfosci <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "College of Information Studies") %>%
  filter(category_status_cd %in%  c("15", "03", "37")) %>%
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  )

nonjour <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "Philip Merrill College of Journalism") %>%
  filter(category_status_cd %in%  c("15", "03", "37")) %>%
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  )

nonbusiness <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "Robert H. Smith School of Business") %>%
  filter(category_status_cd %in%  c("15", "03", "37")) %>%
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  )

nonarchitecture <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "School of Architecture, Planning, & Preservation") %>%
  filter(category_status_cd %in%  c("15", "03", "37")) %>%
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  )

nonsph <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "School of Public Health") %>%
  filter(category_status_cd %in%  c("15", "03", "37")) %>%
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  )

nonpolicy <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(division == "School of Public Policy") %>%
  filter(category_status_cd %in%  c("15", "03", "37")) %>%
  mutate(appt_base_annual_salary = as.numeric(appt_base_annual_salary)) %>%
  summarise(
    appt_base_annual_salary = median(appt_base_annual_salary, na.rm=TRUE)
  )

```



# duplicate names

```{r}

duplicate_names <- salary_2022 %>%
  as.data.frame() %>%
  clean_names() %>%
  group_by(category_status_cd, primary_name) %>%
  count(primary_name) %>%
  filter(n>1)



```






